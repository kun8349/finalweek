import{m as M,D as C}from"./DelModal-d6a073cd.js";import{_ as U,o as l,c as i,b as t,A as r,B as c,F as y,j as w,k as L,X as V,d as h,w as B,r as b,t as f,p as D,f as N}from"./index-d9a35d42.js";import{P as I}from"./PaginationView-9856bd91.js";import{S as m}from"./sweetalert2.all-ad3517e2.js";const A={props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{status:{},modal:"",tempProduct:{}}},emits:["update-product"],mixins:[M],watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}}},E={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},S={class:"modal-dialog modal-lg"},T={class:"modal-content"},F={class:"modal-header bg-secondary text-black"},j={class:"modal-title text-white",id:"productModalLabel"},O={key:0},R={key:1},H=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},X={class:"row"},q={class:"col-4"},z={class:"mb-4"},J=t("label",{class:"form-label"},"主要圖片",-1),K={key:0},Q=["src"],W={key:0},Y=t("label",{class:"form-label"},"圖片網址",-1),Z=["onUpdate:modelValue"],$={key:0},tt=["src"],et={key:0},ot={key:1},st={class:"col-8"},lt={class:"mb-3"},it=t("label",{class:"form-label"},"產品名稱",-1),nt={class:"row"},dt={class:"col-6"},rt={class:"mb-3"},ct=t("label",{class:"form-label"},"分類",-1),at={class:"col-6"},ut={class:"mb-3"},pt=t("label",{class:"form-label"},"單位",-1),mt={class:"col-6"},_t=t("label",{class:"form-label"},"原價",-1),ht={class:"col-6"},bt=t("label",{class:"form-label"},"售價",-1),ft=t("hr",null,null,-1),gt={class:"mb-3"},Pt=t("label",{class:"form-label"},"產品描述",-1),vt={class:"mb-3"},yt=t("label",{class:"form-label"},"說明內容",-1),Ut={class:"mb-3"},wt=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),xt={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-outline-textSecondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Mt(n,o,u,_,e,a){return l(),i("div",E,[t("div",S,[t("div",T,[t("div",F,[t("h5",j,[u.isNew===!0?(l(),i("span",O,"新增產品")):(l(),i("span",R,"編輯產品"))]),H]),t("div",G,[t("div",X,[t("div",q,[t("div",z,[J,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":o[0]||(o[0]=s=>e.tempProduct.imageUrl=s)},null,512),[[c,e.tempProduct.imageUrl]]),e.tempProduct.imageUrl?(l(),i("img",{key:1,src:e.tempProduct.imageUrl,alt:"主要圖片",class:"img-fluid mt-3"},null,8,Q)):(l(),i("span",K))]),Array.isArray(e.tempProduct.imagesUrl)?(l(),i("div",W,[(l(!0),i(y,null,w(e.tempProduct.imagesUrl,(s,p)=>(l(),i("div",{class:"mb-4",key:p+"img"},[Y,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":v=>e.tempProduct.imagesUrl[p]=v},null,8,Z),[[c,e.tempProduct.imagesUrl[p]]]),s?(l(),i("img",{key:1,src:s,alt:"次要圖片",class:"img-fluid mt-3"},null,8,tt)):(l(),i("span",$))]))),128)),!e.tempProduct.imagesUrl.length||e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]?(l(),i("div",et,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm w-100",onClick:o[1]||(o[1]=()=>e.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(l(),i("div",ot,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:o[2]||(o[2]=()=>e.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):L("",!0)]),t("div",st,[t("div",lt,[it,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入產品名稱","onUpdate:modelValue":o[3]||(o[3]=s=>e.tempProduct.title=s)},null,512),[[c,e.tempProduct.title]])]),t("div",nt,[t("div",dt,[t("div",rt,[ct,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":o[4]||(o[4]=s=>e.tempProduct.category=s)},null,512),[[c,e.tempProduct.category]])])]),t("div",at,[t("div",ut,[pt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":o[5]||(o[5]=s=>e.tempProduct.unit=s)},null,512),[[c,e.tempProduct.unit]])])]),t("div",mt,[t("div",null,[_t,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":o[6]||(o[6]=s=>e.tempProduct.origin_price=s)},null,512),[[c,e.tempProduct.origin_price,void 0,{number:!0}]])])]),t("div",ht,[t("div",null,[bt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":o[7]||(o[7]=s=>e.tempProduct.price=s)},null,512),[[c,e.tempProduct.price,void 0,{number:!0}]])])])]),ft,t("div",gt,[Pt,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":o[8]||(o[8]=s=>e.tempProduct.description=s)},`\r
                            `,512),[[c,e.tempProduct.description]])]),t("div",vt,[yt,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":o[9]||(o[9]=s=>e.tempProduct.content=s)},`\r
                            `,512),[[c,e.tempProduct.content]])]),t("div",null,[t("div",Ut,[r(t("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[10]||(o[10]=s=>e.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[V,e.tempProduct.is_enabled]]),wt])])])])]),t("div",xt,[kt,t("button",{type:"button",class:"btn btn-primary",onClick:o[11]||(o[11]=()=>n.$emit("update-product",e.tempProduct))}," 確認 ")])])])],512)}const Ct=U(A,[["render",Mt]]);const{VITE_URL:g,VITE_PATH:P}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kevin-jiang",BASE_URL:"/finalweek/",MODE:"production",DEV:!1,PROD:!0},Lt={data(){return{isLoading:!0,fullPage:!1,color:"#BBFFFF",isNew:!0,productList:[],tempProduct:{imagesUrl:[]},currentPage:1,pages:{}}},components:{ProductModal:Ct,Pagination:I,DelModal:C},methods:{getProducts(n=1){this.isLoading=!0,this.currentPage=n,this.$http.get(`${g}api/${P}/admin/products/?page=${n}`).then(o=>{this.productList=o.data.products,this.pages=o.data.pagination,this.isLoading=!1}).catch(()=>{m.fire({icon:"error",title:"資料取得失敗,請重新登入٩(ŏ﹏ŏ、)۶",showConfirmButton:!1,timer:1e3})})},createImg(){this.product.imagesUrl=[],this.product.imagesUrl.push("")},openModal(n,o){n==="new"?(this.isNew=!0,this.tempProduct={imagesUrl:[]}):(this.tempProduct={...o},this.isNew=!1),this.$refs.productModal.openModal()},updateProduct(n){this.tempProduct=n,this.isLoading=!0;let o=`${g}/api/${P}/admin/product`,u="post",_="新增產品成功d(`･∀･)b",e="新增產品失敗٩(ŏ﹏ŏ、)۶";this.isNew||(o=`${g}/api/${P}/admin/product/${this.tempProduct.id}`,u="put",_="修改產品成功d(`･∀･)b",e="修改產品失敗٩(ŏ﹏ŏ、)۶"),this.$http[u](o,{data:this.tempProduct}).then(a=>{this.$refs.productModal.hideModal(),this.getProducts(),this.isLoading=!1,m.fire({position:"top-end",icon:"success",title:_,showConfirmButton:!1,timer:1500,toast:!0})}).catch(()=>{this.isLoading=!1,m.fire({icon:"success",title:e,showConfirmButton:!1,timer:1500})})},openDelProductModal(n){this.tempProduct={...n},this.$refs.delModal.openModal()},delProduct(){this.isLoading=!0,this.$http.delete(`${g}api/${P}/admin/product/${this.tempProduct.id}`).then(()=>{this.$refs.delModal.hideModal(),this.getProducts(this.currentPage),this.isLoading=!1,m.fire({position:"top-end",icon:"success",title:"成功刪除單一產品d(`･∀･)b",showConfirmButton:!1,timer:1500,toast:!0})}).catch(()=>{this.isLoading=!1,m.fire({icon:"success",title:"刪除單一品項失敗٩(ŏ﹏ŏ、)۶",showConfirmButton:!1,timer:1500})})}},mounted(){this.getProducts()}},x=n=>(D("data-v-82eb2a70"),n=n(),N(),n),Vt=x(()=>t("div",{id:"load"},[t("div",null,"G"),t("div",null,"N"),t("div",null,"I"),t("div",null,"D"),t("div",null,"A"),t("div",null,"O"),t("div",null,"L")],-1)),Bt={class:"mb-5 mt-10 text-end"},Dt={class:"table"},Nt=x(()=>t("thead",null,[t("tr",null,[t("th",{width:"100px"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120px"},"原價"),t("th",{width:"120px"},"售價"),t("th",{width:"100px"},"是否啟用"),t("th",{width:"120px"},"編輯")])],-1)),It={class:"table-group-divider"},At={key:0,class:"text-success"},Et={key:1},St={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},Tt=["onClick"],Ft=["onClick"],jt={class:"d-flex justify-content-center"};function Ot(n,o,u,_,e,a){const s=b("AppLoading"),p=b("Pagination"),v=b("ProductModal"),k=b("DelModal");return l(),i(y,null,[t("div",null,[h(s,{active:e.isLoading,"onUpdate:active":o[0]||(o[0]=d=>e.isLoading=d)},{default:B(()=>[Vt]),_:1},8,["active"])]),t("div",Bt,[t("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=()=>a.openModal("new"))},"建立新產品")]),t("table",Dt,[Nt,t("tbody",It,[(l(!0),i(y,null,w(e.productList,d=>(l(),i("tr",{key:d.id+"後台產品列表"},[t("td",null,f(d.category),1),t("td",null,f(d.title),1),t("td",null,f(d.origin_price),1),t("td",null,f(d.price),1),t("td",null,[d.is_enabled?(l(),i("span",At,"啟用")):(l(),i("span",Et,"未啟用"))]),t("td",null,[t("div",St,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>a.openModal("edit",d)},"編輯",8,Tt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>a.openDelProductModal(d)}," 刪除 ",8,Ft)])])]))),128))])]),t("div",jt,[h(p,{pages:e.pages,onEmitPages:a.getProducts},null,8,["pages","onEmitPages"])]),h(v,{onUpdateProduct:a.updateProduct,product:e.tempProduct,isNew:e.isNew,ref:"productModal"},null,8,["onUpdateProduct","product","isNew"]),h(k,{item:e.tempProduct,onDelItem:a.delProduct,ref:"delModal"},null,8,["item","onDelItem"])],64)}const qt=U(Lt,[["render",Ot],["__scopeId","data-v-82eb2a70"]]);export{qt as default};
